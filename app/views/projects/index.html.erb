
<% if current_user.type == "Admin" %>
  <h1>Projects</h1>

  <table border="solid">
    <tr>
      <th>Title</th>
      <th>Description</th>
      <th>Attachments</th>
      <th>Clients</th>
      <th>Project Manager</th>
      <th colspan="3">Actions</th>

      <% @projects.each do |project| %>
        <tr>
          <td><%= project.title %></td>
          <td><%= project.description %></td>
          <td><% project.attachments.each do |attachment| %>
                <%= link_to attachment.file.identifier, attachment.url,
                        target: :_blank %><br>
              <% end %>
          </td>
          <td><% project.clients.each do |client| %>
                <%= client.full_name %><br>
              <% end %>
          </td>
          <td><% role = project.roles.where(:role => "projectmanager").take %>
                <% if !role.nil? %>
                  <%= role.employee.full_name %>
                <% end %>
          </td>

          <td><%= link_to 'Edit', edit_project_path(project) %></td>
          <td><%= link_to 'Delete', project_path(project), method: :delete,
                                        data: { confirm: 'Are you sure?' } %>
          <td><%#= link_to 'Assign', assign_to_project_path(project) %></td>
      <% end %>

  </table><br>


  <p>
    <%= link_to 'New project', new_project_path %>
  </p>

  <p>
    <%= link_to "Back", root_path, class: 'back-button' %>
  </p>

<% end %>
